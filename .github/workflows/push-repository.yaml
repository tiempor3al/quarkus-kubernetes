name: build images and update templates
on:
  push:
    branches:
      - main
jobs:
  build-and-push:
    runs-on: ubuntu-latest
    steps:
      -
        name: Checkout
        uses: actions/checkout@v4
        with:
          repository:  ${{ github.repository_owner }}/k3s-templates
          token: ${{ secrets.TOKEN }}
      -

        name: Update template 
        run: |
          
          git config user.name github-actions
          git config user.email github-actions@github.com

          # sed -i "s|\(image: ${{ github.repository_owner }}/quarkus-kubernetes:\).*|\1v${{ steps.date_generator.outputs.date }}|" k8s_template/app_stack.yaml
          touch file.txt
          git add .
          git commit -m "Updated template to version: v${{ steps.date_generator.outputs.date }}"
          git push 
